<div class="main-content">
    <!-- spinner region -->
    <div class="panel-container-spinner" *ngIf="showSpinner">
        <app-spinner class="spinner-container"></app-spinner>
    </div>
    <!-- end spinner region -->
    <div class="row">
        <div class="col-md-12">
            <!--#region watermark-->
            <div class="watermark" hidden>
                <h6>{{this.companyName}}</h6>
                <h6>{{this.userName}}</h6>
                <h6>{{this.sysDate | date}} {{this.currentTime}}</h6>
            </div>
            <!--#endregion watermark-->
            <div class="card-body ">
                <!--#region form-->
                <form #deliverydetailForm="ngForm">
                    <!-- (ngSubmit)="onFormSubmit(deliverydetailForm.value, deliverydetailForm.valid)"> -->

                    <!--#region button Save, Back-->
                    <button [hidden]="modelHeader.desk_status !== 'HOLD'" type="submit" class="btn btn-info btn-round"
                        data-role="R00020970002099C">Save
                    </button>

                    <button type="button" class="btn btn-danger btn-round" (click)="btnBack()">Back</button>
                    <!--#endregion button Save, Back-->

                    <!--#region row-->
                    <div class="row">
                        <input hidden type="text" class="form-control" [ngModel]="this.params" name="p_id" readonly>

                        <!--#region invoice_no -->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Invoice No</label>
                                <input type="text" class="form-control" [ngModel]="model.invoice_no" name="p_invoice_no"
                                    readonly>
                            </div>
                        </div>
                        <!--#endregion invoice_no -->

                        <!--#region invoice_type -->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Invoice Type</label>
                                <input type="text" class="form-control" [ngModel]="model.invoice_type"
                                    name="p_invoice_type" readonly>
                            </div>
                        </div>
                        <!--#endregion invoice_type -->

                        <!--#region ovd_days -->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>OVD Days</label>
                                <input type="text" class="form-control col-md-4" [ngModel]="model.ovd_days"
                                    name="p_ovd_days" readonly>
                            </div>
                        </div>
                        <!--#endregion ovd_days -->

                        <!--#region billing_date-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="billing_date" class="control-label">Billing Date
                                </label>
                                <input class="form-control col-md-6" placeholder="dd/mm/yyyy" angular-mydatepicker
                                    [ngModel]="model.billing_date" name="p_billing_date" [options]="myDatePickerOptions"
                                    #p_billing_date="ngModel" #billing_date="angular-mydatepicker" autocomplete="off"
                                    readonly />
                            </div>
                        </div>
                        <!--#endregion billing_date-->

                        <!--#region billing_mode_date-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="billing_mode_date" class="control-label">New Billing Date
                                </label>
                                <input class="form-control col-md-6" placeholder="dd/mm/yyyy" angular-mydatepicker
                                    [ngModel]="model.billing_mode_date" name="p_billing_mode_date"
                                    [options]="myDatePickerOptions" #p_billing_date="ngModel"
                                    #billing_mode_date="angular-mydatepicker" autocomplete="off" readonly />
                            </div>
                        </div>
                        <!--#endregion billing_mode_date-->

                        <!--#region billing_due_date-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="billing_due_date" class="control-label">Billing Due Date
                                </label>
                                <input class="form-control col-md-6" placeholder="dd/mm/yyyy" angular-mydatepicker
                                    [ngModel]="model.billing_due_date" name="p_billing_due_date"
                                    [options]="myDatePickerOptions" #p_billing_date="ngModel"
                                    #billing_due_date="angular-mydatepicker" autocomplete="off" readonly />
                            </div>
                        </div>
                        <!--#endregion billing_due_date-->

                        <!--#region total_billing_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="total_billing_amount" class="control-label">Billing Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.total_billing_amount | number : '1.2-2'"
                                    name="p_total_billing_amount" [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion total_billing_amount-->

                        <!--#region total_ppn_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="total_ppn_amount" class="control-label">PPN Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.total_ppn_amount | number : '1.2-2'" name="p_total_ppn_amount"
                                    [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion total_ppn_amount-->

                        <!--#region total_pph_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="total_pph_amount" class="control-label">PPH Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.total_pph_amount | number : '1.2-2'" name="p_total_pph_amount"
                                    [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion total_pph_amount-->

                        <!--#region partial_billing_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="partial_billing_amount" class="control-label">Partial Billing Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.partial_billing_amount | number : '1.2-2'"
                                    name="p_partial_billing_amount" [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion partial_billing_amount-->

                        <!--#region partial_ppn_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="partial_ppn_amount" class="control-label">Partial PPN Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.partial_ppn_amount | number : '1.2-2'" name="p_partial_ppn_amount"
                                    [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion partial_ppn_amount-->

                        <!--#region partial_pph_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="partial_pph_amount" class="control-label">Partial PPH Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.partial_pph_amount | number : '1.2-2'" name="p_partial_pph_amount"
                                    [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!-- #endregion partial_pph_amount -->

                        <!--#region overdue installment amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="overdue_installment_amount" class="control-label">OS Billing Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.overdue_installment_amount | number : '1.2-2'"
                                    name="p_overdue_installment_amount" [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion overdue installment amount-->

                        <!--#region overdue installment amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="overdue_installment_amount" class="control-label">OS PPN Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.overdue_installment_amount | number : '1.2-2'"
                                    name="p_overdue_installment_amount" [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion overdue installment amount-->

                        <!--#region overdue installment amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="overdue_installment_amount" class="control-label">OS PPH Amount
                                </label>
                                <input type="text" style="text-align:right" class="form-control col-md-6"
                                    [ngModel]="model.overdue_installment_amount | number : '1.2-2'"
                                    name="p_overdue_installment_amount" [readonly]="model.desk_status !== 'HOLD'">
                            </div>
                        </div>
                        <!--#endregion overdue installment amount-->

                        <!--#region last_partial_payment_date-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="last_partial_payment_date" class="control-label">Last Partial Payment Date
                                </label>
                                <input class="form-control col-md-6" placeholder="dd/mm/yyyy" angular-mydatepicker
                                    [ngModel]="model.last_partial_payment_date" name="p_last_partial_payment_date"
                                    [options]="myDatePickerOptions" #p_billing_date="ngModel"
                                    #last_partial_payment_date="angular-mydatepicker" autocomplete="off" readonly />
                            </div>
                        </div>
                        <!--#endregion last_partial_payment_date-->

                        <!--#region result code-->
                        <!-- <div class="col-md-4">
                            <div class="form-group">
                                <label for="code" class="control-label">Result *</label>
                                <div class="col-md-12 buttons">
                                    <span>
                                        <button [disabled]="modelHeader.desk_status !== 'HOLD'"
                                            class="btn btn-icon btn-outline-default btn-round btn-md btn-lookup-margin"
                                            type="button" (click)="btnLookupMasterDeskcollResult()" data-toggle="modal"
                                            data-target="#lookupModalMasterDeskcollResult" href="#"><i
                                                class="fa fa-search-plus"></i></button>
                                        {{model.result_name}}
                                        <input type="hidden" class="form-control" [ngModel]="model.result_code"
                                            name="p_result_code" required #result_code="ngModel">
                                        <input type="hidden" class="form-control" [ngModel]="model.value"
                                            name="p_value">
                                    </span>
                                </div>
                                <small
                                    [hidden]="result_code.valid || (result_code.pristine && !deliverydetailForm.submitted)"
                                    class="text-danger">
                                    Result is required
                                </small>
                            </div>
                        </div> -->
                        <!--#endregion result code-->

                        <!--#region remark-->
                        <div class="col-md-4">
                            <div class="form-group" [class.has-error]="remark.invalid && remark.touched">
                                <label for="remark" class="control-label">Remark * </label>
                                <textarea type="text" class="form-control" [ngModel]="model.remark" name="p_remark"
                                    required #remark="ngModel"
                                    [disabled]="modelHeader.desk_status !== 'HOLD'"></textarea>
                                <small
                                    *ngIf="(remark.errors?.required && remark.touched) || (remark.errors?.required && deliverydetailForm.submitted)"
                                    class="text-danger">
                                    Remarks is required
                                </small>
                            </div>
                        </div>
                        <!--#endregion remark -->
                    </div>
                    <!--#endregion row-->
                </form>
                <!--#endregion form-->
                <!--#region list view-->
                <div *ngIf="param != null">
                    <span layout="row horizontal-divider">
                        <hr flex />
                    </span>
                    <div class="row">
                        <div class="card-header ">
                            <h4 class="card-title">Agreement List</h4>
                        </div>
                        <div class="col-md-12">
                            <!--#region list view-->
                            <table id="datatableApplicationAmortization" datatable [dtOptions]="dtOptions"
                                class="table table-striped table-bordered row-border hover" cellspacing="0"
                                width="100%">
                                <thead>
                                    <tr>
                                        <th style="display: none;"></th>
                                        <th class="disabled-sorting">No</th>
                                        <th>Agreement No</th>
                                        <th>Asset No</th>
                                        <th>Billing No</th>
                                        <th>Description</th>
                                        <th>Monthly Rental Amount</th>
                                        <th>Billing Amount</th>
                                        <th>PPN Amount</th>
                                        <th>PPH Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let row of listamortization;let i=index ">
                                        <td class="if-no-edit-btn" style="display: none;"></td>
                                        <td class="if-no-edit-btn" style="text-align: center;">
                                            {{listamortization.numberIndex+i+1}}</td>
                                        <td style="width: 10%;text-align: center;">{{row.agreement_external_no}}</td>
                                        <td style="width: 15%;text-align: left;">{{row.asset_no}} <br>
                                            {{row.asset_name}}</td>
                                        <td style="width: 10%;text-align: center;">{{row.billing_no}}</td>
                                        <td style="width: 15%;">{{row.description}}</td>
                                        <td style="width: 15%;text-align: right;">{{row.monthly_rental_rounded_amount |
                                            number :
                                            '1.2-2'}}</td>
                                        <td style="width: 15%;text-align: right;">{{row.billing_amount | number :
                                            '1.2-2'}}</td>
                                        <td style="width: 10%;text-align: right;">{{row.ppn_amount | number :
                                            '1.2-2'}}</td>
                                        <td style="width: 10%;text-align: right;">{{row.pph_amount | number :
                                            '1.2-2'}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <!--#endregion list view-->
                        </div>
                    </div>
                </div>
                <!--#endregion list view-->
            </div>
        </div>
    </div>
</div>

<!--#region lookup lookupMasterDeskcollResult-->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalMasterDeskcollResult"
    style="margin-top: -65px">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body" style="overflow:hidden;">
                <div class="col-md-12">
                    <div class="card-body col-md-12">

                        <table id="datatableLookupMasterDeskcollResult"
                            class="table table-striped table-bordered row-border hover" cellspacing="0"
                            style="min-width: 100%;">
                            <thead>
                                <tr>
                                    <th style="display: none;"></th>
                                    <th class="disabled-sorting">No</th>
                                    <th style="width: 20%;">Code</th>
                                    <th style="width: 75%;">Name</th>
                                    <th style="text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of lookupMasterDeskcollResult;let i=index ">
                                    <td style="display: none;"></td>
                                    <td style="text-align: center;">
                                        {{lookupMasterDeskcollResult.numberIndex+i+1}}</td>
                                    <td style="text-align: center; width: 30%;">{{ row.code }}</td>
                                    <td style="text-align: left; width: 70%;">{{ row.result_name }}</td>
                                    <td class="text-center">
                                        <button class="btn btn-outline-default btn-round"
                                            (click)="btnSelectRowMasterDeskcollResult(row.code,row.result_name)">Select</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--#endregion lookup lookupMasterDeskcollResult-->