<div class="main-content">
  <!-- spinner region -->
  <div class="panel-container-spinner" *ngIf="showSpinner">
    <app-spinner class="spinner-container"></app-spinner>
  </div>
  <!-- end spinner region -->
  <div class="row">
    <div class="col-md-12">
      <div class="card ">
        <!--#region watermark-->
        <div class="watermark" hidden>
          <h6>{{this.companyName}}</h6>
          <h6>{{this.userName}}</h6>
          <h6>{{this.sysDate | date}} {{this.currentTime}}</h6>
        </div>
        <!--#endregion watermark-->

        <div class="card-header ">
          <h5 class="card-title">Write Off Info</h5>
        </div>
        <div class="card-body ">
          <!--#region form-->
          <!--#region writeoffDetail form-->
          <form #writeoffForm="ngForm" (ngSubmit)="onFormSubmit(writeoffForm.value, writeoffForm.valid)">

            <!--#region writeoffDetail button submit dan back-->
            <button type="submit" [hidden]="isButton" class="btn btn-info btn-round"
              data-role="R00020890022090C">Save</button>
            <button [hidden]="isButton || param == null" type="button" class="btn btn-success btn-round"
              (click)="btnProceed(writeoffForm.valid)" data-role="R00020890002090O">Proceed</button>
            <button [hidden]="isButton || param == null" type="button" class="btn btn-warning btn-round"
              (click)="btnCancel()" data-role="R00020890002090R">Cancel</button>
            <button type="button" class="btn btn-danger btn-round" (click)="btnBack()">Back</button>
            <button [hidden]="this.param === null || model.wo_status === 'CANCEL'" type="button" style='float: right;'
              class="btn btn-success btn-round custom-button-width" (click)="btnViewApproval()" data-toggle="modal"
              data-target="#lookupModalApproval" href="#">
              View Approval
            </button>
            <!-- <button type="button" style='float: right;' class="btn btn-info btn-print-round custom-button-width"
            (click)="btnPrint()" data-role="R00020890022091P">Print Somasi</button> -->
            <button type="button" style='float: right;'
              class="btn btn-info btn-print-round btn-round custom-button-width" (click)="btnPrintSuratTagih()"
              data-role="R00020890022091P" [hidden]="param == null">Print
              Surat Tagih </button>
            <!--#writeoff detail button submit dan back-->

            <!--#region writeoff detail row-->
            <div class="row">
              <!--#region code-->
              <div class="col-md-4">
                <div [hidden]="model.code != null" class="row" style="margin-bottom: -15px; padding-top: 30px;">
                  <h1 class="col-md-4" style="font-size: 12px;">Write Off No</h1>
                  <h1 class="col-md-8" style="font-size: 12px;">-Auto
                    Generate-</h1>
                </div>
                <div [hidden]="this.param == null" class="form-group">
                  <label>Write Off No </label>
                  <input type="text" class="form-control" [ngModel]="model.code" name="p_code" [readonly]="isReadOnly">
                </div>
              </div>
              <!--#endregion code-->

              <!--#region writeoff Branch Code-->
              <div class="col-md-4">
                <div class="form-group">
                  <label class="labelmodule">Branch *</label>
                  <div class="col-md-12">
                    <span>
                      <button [disabled]="model.code != null" class="btn btn-icon btn-outline-default btn-round btn-md"
                        type="button" (click)="btnLookupBranch()" data-toggle="modal" data-target="#lookupModalBranch"
                        href="#"><i class="fa fa-search-plus"></i></button>
                      {{model.branch_name}}
                      <input type="hidden" class="form-control" [ngModel]="model.branch_code" name="p_branch_code"
                        required #branch_code="ngModel">
                      <input type="hidden" class="form-control" [ngModel]="model.branch_name" name="p_branch_name"
                        required #branch_name="ngModel">
                    </span>
                  </div>
                  <small [hidden]="branch_name.valid || (branch_name.pristine && !writeoffForm.submitted)"
                    class="text-danger">
                    Branch is required
                  </small>

                </div>
              </div>
              <!--#endregion writeoff Branch Code-->

              <!--#region Order WO Status-->
              <div class="col-md-4">
                <div class="form-group">
                  <label>Status</label>
                  <input type="text" class="form-control" [ngModel]="model.wo_status" name="p_wo_status" readonly>
                </div>
              </div>
              <!--#endregion WO Status-->
            </div>
            <!--#endregion writeoff detail row-->

            <!--#region writeoff detail row-->
            <div class="row">
              <!--#region WO Date-->
              <div class="col-md-4">
                <div class="form-group">
                  <label for="p_wo_date" class="control-label">Date *</label>
                  <input [readonly]="isButton" [ngStyle]="getStyles(isButton)" class="form-control col-md-6"
                    placeholder="dd/mm/yyyy" angular-mydatepicker [ngModel]="model.wo_date" name="p_wo_date"
                    [options]="myDatePickerOptions" (click)="wo_date.toggleCalendar()" required #p_wo_date="ngModel"
                    #wo_date="angular-mydatepicker" autocomplete="off" />
                  <small
                    *ngIf="p_wo_date.errors?.required && p_wo_date.touched || (p_wo_date.errors?.required && writeoffForm.submitted) "
                    class="text-danger">
                    Date is required
                  </small>
                </div>
              </div>
              <!--#endregion WO Date-->

              <!--#region lookup Agreement -->
              <div class="col-md-4">
                <div class="form-group">
                  <label>Agreement No *</label>
                  <div class="col-md-12">
                    <span>
                      <button [disabled]="model.code != null" class="btn btn-icon btn-outline-default btn-round btn-md"
                        type="button" (click)="btnLookupAgreement()" data-toggle="modal"
                        data-target="#lookupModalAgreement" href="#"><i class="fa fa-search-plus"></i></button>
                      {{model.agreement_external_no}}
                      <input type="hidden" class="form-control" [ngModel]="model.agreement_no" name="p_agreement_no"
                        required #agreement_no="ngModel">
                    </span>
                  </div>
                  <small [hidden]="agreement_no.valid || (agreement_no.pristine && !writeoffForm.submitted)"
                    class="text-danger">
                    Agreement No is required
                  </small>
                </div>
              </div>
              <!--#endregion lookup Agreement -->

              <!--#region Client Name-->
              <div class="col-md-4">
                <div class="form-group">
                  <label for="client_name" class="control-label">Client Name</label>
                  <input type="text" class="form-control" [ngModel]="model.client_name" name="p_client_name" readonly>
                </div>
              </div>
              <!--#endregion Client Name-->
            </div>
            <!--#endregion writeoff detail row-->

            <!--#region writeoff detail row-->
            <div class="row">
              <!--#region WO Type-->
              <!-- <div class="col-md-4">
                <div class="form-group">
                  <label>WO Type</label> -->
              <input type="text" hidden class="form-control" [ngModel]="model.wo_type" name="p_wo_type" readonly>
              <!-- <select class="form-control col-md-6" [ngModel]="model.wo_type" name="p_wo_type2" disabled
                    style="appearance: none; -webkit-appearance: none; -moz-appearance: none;"
                    (change)="WoType($event)">
                    <option value="WO ACC" [hidden]="model.agreement_sub_status === 'WO ACC'">Hapus Buku</option>
                    <option value="WO COLL" [hidden]="model.agreement_sub_status !== 'WO ACC'">Hapus Tagih</option>
                  </select>
                </div>
              </div> -->
              <!--#endregion WO Type-->

              <!--#region WO Amount-->
              <div class="col-md-4">
                <div class="form-group">
                  <label for="wo_amount" class="control-label">Amount </label>
                  <input style="text-align:right" type="text" class="form-control col-md-6"
                    [ngModel]="model.wo_amount | number : '1.2-2'" name="p_wo_amount" amount="wo_amount" readonly>
                </div>
              </div>
              <!--#endregion WO Amount-->

              <!--#region WO Remarks-->
              <div class="col-md-4">
                <div class="form-group">
                  <label for="wo_remarks" class="control-label">Remark *</label>
                  <textarea [readonly]="isButton" type="text" class="form-control" [ngModel]="model.wo_remarks"
                    maxlength="4000" name="p_wo_remarks" required #wo_remarks="ngModel"></textarea>
                  <small
                    *ngIf="wo_remarks.errors?.required && wo_remarks.touched || (wo_remarks.errors?.required && writeoffForm.submitted) "
                    class="text-danger">
                    Remark is required
                  </small>
                </div>
              </div>
              <!--#endregion WO Remarks-->
            </div>
            <!--#endregion writeoff detail row-->
          </form>
          <!--#endregion form-->
        </div>

        <!--#region wizard-->
        <div class="wizard-custom-margin" [hidden]="param == null">
          <!--#region wizard container -->
          <div class="wizard-container">
            <div class="card-wizard" style="opacity: 1 !important; min-height: 0px;" data-color="primary"
              id="wizardProfile">
              <div class="text-center">
                <div class="wizard-navigation">
                  <ul>
                    <li class="nav-item">
                      <a class="nav-link" (click)="writeoffdetailwiz()" href="#writeoffdetaillist" data-toggle="tab"
                        role="tab" aria-controls="writeoffdetaillist" aria-selected="true">
                        Asset
                      </a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" (click)="writeoffinformationwiz()" href="#writeoffinformationlist"
                        data-toggle="tab" role="tab" aria-controls="writeoffinformationlist" aria-selected="true">
                        Information
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <!--#endregion wizard container-->
        </div>
        <!--endregion wizard-->
        <router-outlet></router-outlet>
      </div>
    </div>
  </div>
</div>

<!--#region lookup Approval-->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalApproval"
  style="margin-top: -65px">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body" style="overflow:hidden;">
        <div class="col-md-12">
          <div class="card-body col-md-12">

            <table id="datatableLookupApproval" class="table table-striped table-bordered hover" cellspacing="0"
              style="min-width: 100%;">
              <thead>
                <tr>
                  <th style="display: none;"></th>
                  <th class="disabled-sorting">No</th>
                  <th>Employee</th>
                  <th>Position</th>
                  <th>Level</th>
                  <th>Result</th>
                  <th>Remark</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of lookupapproval;let i=index ">
                  <td style="display: none;"></td>
                  <td style="text-align: center;">{{lookupapproval.numberIndex+i+1}}</td>
                  <td class="if-no-edit-btn" style="width: 30%;text-align: left;">
                    {{row.emp_name}} {{row.is_mandatory_level}}</td>
                  <td style="width: 20%;text-align: left;">{{row.emp_position_name}}</td>
                  <td style="width: 5%;text-align: center;">{{row.approval_level}}</td>
                  <td style="width: 15%;text-align: center;">
                    {{row.result_status}}<br>
                    {{row.result_date}}
                  </td>
                  <td style="width: 30%;">{{row.result_remarks}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--#endregion lookup Approval-->

<!--#region lookup Branch-->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalBranch"
  style="margin-top: -65px">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body" style="overflow:hidden;">
        <div class="col-md-12">
          <div class="card-body col-md-12">

            <table id="datatableLookupBranch" class="table table-striped table-bordered hover" cellspacing="0"
              style="min-width: 100%;">
              <thead>
                <tr>
                  <th style="display: none;"></th>
                  <th class="disabled-sorting">No</th>
                  <th>Code</th>
                  <th>Name</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of lookupbranch;let i=index">
                  <td style="display: none;"></td>
                  <td class="if-no-edit-btn" style="text-align: center;">{{lookupbranch.numberIndex+i+1}}</td>
                  <td style="width: 20%; text-align: center;">{{ row.code }}</td>
                  <td style="width: 80%;">{{ row.name }}</td>
                  <td class="text-center">
                    <button class="btn btn-outline-default btn-round"
                      (click)="btnSelectRowBranch(row.code, row.name)">Select</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--#endregion lookup Branch-->

<!--#region modal lookup Agreement-->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalAgreement"
  style="margin-top: -65px">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body" style="overflow:hidden;">
        <div class="col-md-12">
          <div class="card-body col-md-12">

            <table id="datatableLookupAgreement" class="table table-striped table-bordered hover" cellspacing="0"
              style="min-width: 100%;">
              <thead>
                <tr>
                  <th style="display: none;"></th>
                  <th class="disabled-sorting">No</th>
                  <th>Agreement No</th>
                  <th>Client Name</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of lookupAgreement;let i=index ">
                  <td style="display: none;"></td>
                  <td class="if-no-edit-btn" style="text-align: center;">{{lookupAgreement.numberIndex+i+1}}</td>
                  <td style="width: 20%; text-align: center;">{{ row.agreement_external_no }}</td>
                  <td style="width: 80%;">{{ row.client_name }}</td>
                  <td class="text-center">
                    <button class="btn btn-outline-default btn-round"
                      (click)="btnSelectRowAgreement(row.agreement_no, row.agreement_external_no, row.client_name, row.agreement_sub_status)">Select</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--#endregion lookup Agreement-->